---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by lize.
--- DateTime: 2021/1/29 10:51 上午
---

function arena_constructor (self, unitId, unitFrame, envTable, modTable)

    local arenaTargets = {}
    envTable.arenaTargets = arenaTargets
    envTable.fontSize = 14
    envTable.fontColor = '#FFD700'

    unitFrame.arenaLabel = unitFrame.arenaLabel or Plater:CreateLabel (unitFrame.healthBar.FrameOverlay, label,
            envTable.fontSize,
            envTable.fontColor)
    unitFrame.arenaLabel:SetPoint ('center', 0, 0)

    local function initTable()
        if (Plater.ZoneInstanceType == "arena") then
            local oppNums = GetNumArenaOpponents()
            for i = 1, oppNums do
                local atName = GetUnitName('arena'..i, true)
                if atName then
                    arenaTargets[atName] = i
                end
            end
        end
    end

    local function wipeTable()
        wipe(arenaTargets)
    end

    local frame, events = CreateFrame("Frame"), {};

    function events:ARENA_OPPONENT_UPDATE(...)
        initTable()
    end

    function events:PLAYER_ENTERING_WORLD(...)
        wipeTable()
    end

    frame:SetScript("OnEvent", function(self, event, ...)
        events[event](self, ...);
    end);

    for k, v in pairs(events) do
        frame:RegisterEvent(k);
    end

end